{"id":57,"date":"2021-07-19T10:20:27","date_gmt":"2021-07-19T10:20:27","guid":{"rendered":"https:\/\/danielkumar.com\/blog\/?p=57"},"modified":"2022-07-27T05:25:36","modified_gmt":"2022-07-27T05:25:36","slug":"cheatsheet-internal-infrastructure-pentesting","status":"publish","type":"post","link":"https:\/\/danielkumar.com\/index.php\/2021\/07\/19\/cheatsheet-internal-infrastructure-pentesting\/","title":{"rendered":"Cheatsheet &#8211; Internal Infrastructure Pentesting"},"content":{"rendered":"\n<p class=\"has-large-font-size\"><strong>Unauthenticated Vectors:<\/strong><\/p>\n\n\n\n<p>Password Spraying:<\/p>\n\n\n\n<ul><li>https:\/\/book.hacktricks.xyz\/windows\/active-directory-methodology\/password-spraying<\/li><li>https:\/\/github.com\/Greenwolf\/Spray<\/li><li>MSF: use auxiliary\/scanner\/smb\/smb_login<\/li><li>CrackMapExec: crackmapexec cmd &lt;targetfile&gt; -u user -p pass -d domain<\/li><\/ul>\n\n\n\n<p>Relaying Credentials with ntlmrelayx:<\/p>\n\n\n\n<ul><li>https:\/\/blog.fox-it.com\/2017\/05\/09\/relaying-credentials-everywhere-with-ntlmrelayx\/<\/li><\/ul>\n\n\n\n<p class=\"has-large-font-size\"><strong>Authenticated Vectors:<\/strong><\/p>\n\n\n\n<p>Start CMD with secondary user credentials:<\/p>\n\n\n\n<ul><li>Local: runas \/netonly \/user:&lt;username&gt; cmd.exe<\/li><li>Domain: runas \/netonly \/user:&lt;domain&gt;\\&lt;username&gt; cmd.exe<\/li><\/ul>\n\n\n\n<p>Log into System:<\/p>\n\n\n\n<ul><li>winrs -r:&lt;computername> cmd.exe<\/li><li>Enter-PSSession -ComputerName &lt;computername><\/li><\/ul>\n\n\n\n<p>Enable PowerShell Remoting<\/p>\n\n\n\n<ul><li>Enable: Enable-PSRemoting \u2013force<\/li><li>Check WinRM Running: Get-WmiObject &#8211;<strong>Class<\/strong> win32_service | Where-Object {$_.name -like &#8220;WinRM&#8221;}<\/li><li>Set  all remote hosts to trusted: Set-Item WSMan:localhost\\client\\trustedhosts -value *<ul><li>Verify Configuration: Get-Item WSMan:\\localhost\\Client\\TrustedHosts<\/li><\/ul><\/li><\/ul>\n\n\n\n<p class=\"has-large-font-size\"><strong>Windows Activities:<\/strong><\/p>\n\n\n\n<p>See: https:\/\/danielkumar.com\/index.php\/2021\/07\/19\/cheatsheet-microsoft-windows\/<\/p>\n","protected":false},"excerpt":{"rendered":"<p>A living cheatsheet of commands and tips i&#8217;ve encountered during my day to day which are good enough to share \ud83d\ude42<\/p>\n<div class=\"more-link-wrapper\"><a class=\"more-link\" href=\"https:\/\/danielkumar.com\/index.php\/2021\/07\/19\/cheatsheet-internal-infrastructure-pentesting\/\">Continue reading<span class=\"screen-reader-text\">Cheatsheet &#8211; Internal Infrastructure Pentesting<\/span><\/a><\/div>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[6,18],"tags":[17,19],"_links":{"self":[{"href":"https:\/\/danielkumar.com\/index.php\/wp-json\/wp\/v2\/posts\/57"}],"collection":[{"href":"https:\/\/danielkumar.com\/index.php\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/danielkumar.com\/index.php\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/danielkumar.com\/index.php\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/danielkumar.com\/index.php\/wp-json\/wp\/v2\/comments?post=57"}],"version-history":[{"count":10,"href":"https:\/\/danielkumar.com\/index.php\/wp-json\/wp\/v2\/posts\/57\/revisions"}],"predecessor-version":[{"id":84,"href":"https:\/\/danielkumar.com\/index.php\/wp-json\/wp\/v2\/posts\/57\/revisions\/84"}],"wp:attachment":[{"href":"https:\/\/danielkumar.com\/index.php\/wp-json\/wp\/v2\/media?parent=57"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/danielkumar.com\/index.php\/wp-json\/wp\/v2\/categories?post=57"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/danielkumar.com\/index.php\/wp-json\/wp\/v2\/tags?post=57"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}